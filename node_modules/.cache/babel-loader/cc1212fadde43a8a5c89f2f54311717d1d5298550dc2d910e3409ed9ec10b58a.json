{"ast":null,"code":"let tasks = 0;\nlet resolves = [];\nexport function startTask() {\n  tasks += 1;\n  return () => {\n    tasks -= 1;\n    if (tasks === 0) {\n      let prevResolves = resolves;\n      resolves = [];\n      for (let i of prevResolves) i();\n    }\n  };\n}\nexport function task(cb) {\n  let endTask = startTask();\n  let promise = cb().finally(endTask);\n  promise.t = true;\n  return promise;\n}\nexport function allTasks() {\n  if (tasks === 0) {\n    return Promise.resolve();\n  } else {\n    return new Promise(resolve => {\n      resolves.push(resolve);\n    });\n  }\n}\nexport function cleanTasks() {\n  tasks = 0;\n}","map":{"version":3,"names":["tasks","resolves","startTask","prevResolves","i","task","cb","endTask","promise","finally","t","allTasks","Promise","resolve","push","cleanTasks"],"sources":["/Users/joseignacio/Developer/caixabanktech-hackathon/node_modules/nanostores/task/index.js"],"sourcesContent":["let tasks = 0\nlet resolves = []\n\nexport function startTask() {\n  tasks += 1\n  return () => {\n    tasks -= 1\n    if (tasks === 0) {\n      let prevResolves = resolves\n      resolves = []\n      for (let i of prevResolves) i()\n    }\n  }\n}\n\nexport function task(cb) {\n  let endTask = startTask()\n  let promise = cb().finally(endTask)\n  promise.t = true\n  return promise\n}\n\nexport function allTasks() {\n  if (tasks === 0) {\n    return Promise.resolve()\n  } else {\n    return new Promise(resolve => {\n      resolves.push(resolve)\n    })\n  }\n}\n\nexport function cleanTasks() {\n  tasks = 0\n}\n"],"mappings":"AAAA,IAAIA,KAAK,GAAG,CAAC;AACb,IAAIC,QAAQ,GAAG,EAAE;AAEjB,OAAO,SAASC,SAASA,CAAA,EAAG;EAC1BF,KAAK,IAAI,CAAC;EACV,OAAO,MAAM;IACXA,KAAK,IAAI,CAAC;IACV,IAAIA,KAAK,KAAK,CAAC,EAAE;MACf,IAAIG,YAAY,GAAGF,QAAQ;MAC3BA,QAAQ,GAAG,EAAE;MACb,KAAK,IAAIG,CAAC,IAAID,YAAY,EAAEC,CAAC,CAAC,CAAC;IACjC;EACF,CAAC;AACH;AAEA,OAAO,SAASC,IAAIA,CAACC,EAAE,EAAE;EACvB,IAAIC,OAAO,GAAGL,SAAS,CAAC,CAAC;EACzB,IAAIM,OAAO,GAAGF,EAAE,CAAC,CAAC,CAACG,OAAO,CAACF,OAAO,CAAC;EACnCC,OAAO,CAACE,CAAC,GAAG,IAAI;EAChB,OAAOF,OAAO;AAChB;AAEA,OAAO,SAASG,QAAQA,CAAA,EAAG;EACzB,IAAIX,KAAK,KAAK,CAAC,EAAE;IACf,OAAOY,OAAO,CAACC,OAAO,CAAC,CAAC;EAC1B,CAAC,MAAM;IACL,OAAO,IAAID,OAAO,CAACC,OAAO,IAAI;MAC5BZ,QAAQ,CAACa,IAAI,CAACD,OAAO,CAAC;IACxB,CAAC,CAAC;EACJ;AACF;AAEA,OAAO,SAASE,UAAUA,CAAA,EAAG;EAC3Bf,KAAK,GAAG,CAAC;AACX","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}